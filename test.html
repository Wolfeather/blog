<!--
 * @Descripttion: 
 * @version: 
 * @Author: wolfeather
 * @Date: 2020-06-09 19:23:01
 * @LastEditors: wolfeather
 * @LastEditTime: 2020-07-20 17:35:31
--> 
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Test</title>
  <style type="text/css">
    .image-item {
	    display: block;
	    margin-bottom: 50px;
	    height: 500px;
	}
  </style>
</head>

<body>
    <img class="image-item"  data-original="imgs/代理.png"/>
    <img class="image-item"  data-original="imgs/原型链1.png"/>
    <img class="image-item"  data-original="imgs/原型链2.png"/>
    <img class="image-item"  data-original="imgs/代理.png"/>
    <img class="image-item"  data-original="imgs/代理.png"/>
    <img class="image-item"  data-original="imgs/代理.png"/>
    <img class="image-item"  data-original="imgs/代理.png"/>
    <img class="image-item"  data-original="imgs/代理.png"/>
    <img class="image-item"  data-original="imgs/代理.png"/>
    <img class="image-item"  data-original="imgs/代理.png"/>
    <img class="image-item"  data-original="imgs/代理.png"/>
    <img class="image-item"  data-original="imgs/代理.png"/>
</body>
<script src="./tools/index.js"></script>
<script>
  var viewHeight = document.documentElement.clientHeight
  function lazyLoad(){
    let eles = document.querySelectorAll('img[data-original]')
    log(eles);
    eles.forEach((item,index)=>{
      // 如果已经加载过  则跳过
      if(!item.dataset.original) return
      let rect = item.getBoundingClientRect();
      // 如果在屏幕内 则加载
      if(rect.bottom>=0 && rect.top < viewHeight){
          let img = new Image()
          img.src=item.dataset.original
          img.onload = function(){
            item.src = img.src
          }
          item.removeAttribute("data-original")
      }
    })
  }
  // 先触发一次 将首页的图片加载
  lazyLoad() 
  document.addEventListener('scroll',throttle(lazyLoad,1000,true))
</script>

</html>